<mvc:View
    controllerName="com.zeim.fatturazionepassiva.controller.Home"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:m="sap.m"
    xmlns:f="sap.f"
    xmlns:card="sap.f.cards"
    xmlns:form="sap.ui.layout.form"
    xmlns:mdc="sap.ui.mdc"
    xmlns:core="sap.ui.core"
    xmlns:smartFilterBar="sap.ui.comp.smartfilterbar"
    xmlns:table="sap.ui.table"
>
    <m:Page
        id="page"
        title="{i18n>title}"
    >
        <!-- Pannello filtro -->
        <m:Panel>
            <m:VBox>
                <mdc:FilterBar
                    id="filterBar"
                    showGoButton="true"
                    search=".onSearch"
                />
            </m:VBox>
        </m:Panel>

        <!-- Elenco fatture -->
        <m:Panel
            headerText="Elenco Fatture"
            width="100%"
        >
            <m:IconTabBar
                id="idIconTabBar"
                select=".onIconTabSelect"
                expandable="false"
                expanded="false"
            >
                <m:items>
                    <m:IconTabFilter
                        key="All"
                        text="Fatture"
                        showAll="true"
                        count="{fattureModel>/Counts/All}"
                    />
                    <m:IconTabSeparator />
                    <m:IconTabFilter
                        key="registrate"
                        text="Registrate"
                        icon="sap-icon://accept"
                        iconColor="Positive"
                        count="{fattureModel>/Counts/Registrate}"
                    />
                    <m:IconTabFilter
                        key="working"
                        text="In lavorazione"
                        icon="sap-icon://pending"
                        iconColor="Critical"
                        count="{fattureModel>/Counts/Working}"
                    />
                    <m:IconTabFilter
                        key="error"
                        text="Da registrare"
                        icon="sap-icon://error"
                        iconColor="Negative"
                        count="{fattureModel>/Counts/Error}"
                    />
                </m:items>
            </m:IconTabBar>

            <table:Table
                id="idTreeTable"
                rows="{path: '/Invoices'}"
                selectionMode="MultiToggle"
                enableColumnReordering="true"
                fixedColumnCount="1"
                rowActionCount="1"
            >
                <table:rowActionTemplate>
                    <table:RowAction>
                        <table:items>
                            <table:RowActionItem
                                icon="sap-icon://navigation-right-arrow"
                                text="Apri Dettaglio"
                                type="Navigation"
                                press=".onVisualizzaDati"
                            />
                        </table:items>
                    </table:RowAction>
                </table:rowActionTemplate>
                <table:rowSettingsTemplate>
                    <table:RowSettings
                        highlight="{path: 'status', formatter: '.getHighlight'}"
                    />
                </table:rowSettingsTemplate>
                <!-- Colonne (lascia invariato) -->
                <table:columns>
                    <table:Column width="5rem">
                        <table:label>
                            <m:Label text="Allegato" />
                        </table:label>
                        <table:template>
                            <m:HBox
                                alignItems="Center"
                                justifyContent="Center"
                                visible="{= ${status} ? true : false }"
                            >
                                <core:Icon
                                    src="sap-icon://attachment"
                                    size="1rem"
                                    color=""
                                    tooltip="{statusText}"
                                />
                            </m:HBox>
                        </table:template>
                    </table:Column>

                    <!-- N. doc. (presente su padre e figlio) -->
                    <table:Column width="10rem">
                        <table:label>
                            <m:Label text="N. doc." />
                        </table:label>
                        <table:template>
                            <m:Text text="{docNumber}" />
                        </table:template>
                    </table:Column>
                    <!-- Esercizio (solo testata, le righe figlie non ce l’hanno) -->
                    <table:Column width="8rem">
                        <table:label>
                            <m:Label text="Esercizio" />
                        </table:label>
                        <table:template>
                            <m:Text text="{fiscalYear}" />
                        </table:template>
                    </table:Column>
                    <!-- Eser St. (semaforo) -> visible solo se esiste 'status' (quindi solo padre) -->
                    <table:Column width="6rem">
                        <table:label>
                            <m:Label text="Stato" />
                        </table:label>
                        <table:template>
                            <m:HBox
                                alignItems="Center"
                                justifyContent="Center"
                                visible="{= ${status} ? true : false }"
                            >
                                <core:Icon
                                    src="sap-icon://circle-task-2"
                                    size="1rem"
                                    color="{= ${status} === 'R' ? 'red' : 'lightgrey'}"
                                    tooltip="{statusText}"
                                />
                                <core:Icon
                                    src="sap-icon://circle-task-2"
                                    size="1rem"
                                    color="{= ${status} === 'Y' ? 'orange' : 'lightgrey'}"
                                    tooltip="{statusText}"
                                />
                                <core:Icon
                                    src="sap-icon://circle-task-2"
                                    size="1rem"
                                    color="{= ${status} === 'G' ? 'green' : 'lightgrey'}"
                                    tooltip="{statusText}"
                                />
                            </m:HBox>
                        </table:template>
                    </table:Column>

                    <!-- Posizione (Figlio) -->
                    <table:Column width="8rem">
                        <table:label>
                            <m:Label text="Tipo Fattura" />
                        </table:label>
                        <table:template>
                            <m:Text text="{tipoFattura}" />
                        </table:template>
                    </table:Column>
                    <!-- Società -->
                    <table:Column width="10rem">
                        <table:label>
                            <m:Label text="Società" />
                        </table:label>
                        <table:template>
                            <m:Text text="{supplier}" />
                        </table:template>
                    </table:Column>
                    <!-- Nome Società-->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Nome della società" />
                        </table:label>
                        <table:template>
                            <m:Text text="{companyName}" />
                        </table:template>
                    </table:Column>
                    <!-- S. Fornitore -->
                    <table:Column width="8rem">
                        <table:label>
                            <m:Label text="Stato Fornitore" />
                        </table:label>
                        <table:template>
                            <m:Text text="da calcolare" />
                        </table:template>
                    </table:Column>
                    <!-- Codice Fornitore -->
                    <table:Column width="8rem">
                        <table:label>
                            <m:Label text="Codice Fornitore" />
                        </table:label>
                        <table:template>
                            <m:Text text="da calcolare" />
                        </table:template>
                    </table:Column>
                    <!-- Nome Fornitore -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Nome Fornitore" />
                        </table:label>
                        <table:template>
                            <m:Text text="{supplierName}" />
                        </table:template>
                    </table:Column>
                    <!-- Gruppo Conti -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Gruppo Conti" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Tipo Documento Cod. -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Tipo Documento Cod." />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Tipo Documento Descr. -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Tipo Documento Descr." />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- numero fattura fornitore. -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="N. Fattura Fornitore" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Divisa -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Divisa" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Data Fattura -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Data Fattura" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Causale -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Causale" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Importo totale -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Importo totale" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Imponibile -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Imponibile" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Doc Contabile -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Doc Contabile" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Data registrazione -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Data registrazione" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Data ricevimento -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Data ricevimento" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- PIVA/CF -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="PIVA/CF" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Gruppo CM -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Gruppo CM" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Descrizione Gruppo CM -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Descrizione Gruppo CM" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Paese -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Paese" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Scadenza Pagamento -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Scadenza Pagamento" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Motivazione Blocco -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Motivazione Blocco" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Blocco -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Blocco" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Archiviato -->
                    <table:Column width="14rem">
                        <table:label>
                            <m:Label text="Archiviato" />
                        </table:label>
                        <table:template>
                            <m:Text text="" />
                        </table:template>
                    </table:Column>
                    <!-- Gr. (rombo/triangolo) -> visibile solo su padre (items non hanno hasWarning) -->
                    <table:Column width="5rem">
                        <table:label>
                            <m:Label text="St. Soc." />
                        </table:label>
                        <table:template>
                            <core:Icon
                                src="sap-icon://status-critical"
                                size="1rem"
                                color="orange"
                                visible="{= ${hasWarning} ? true : false }"
                                tooltip="{warningText}"
                                press=".onShowErrorDialog"
                            />
                        </table:template>
                    </table:Column>
                </table:columns>
            </table:Table>
        </m:Panel>

        <!-- FOOTER -->
        <m:footer>
            <m:OverflowToolbar>
                <m:ToolbarSpacer />

                <!-- 1. OdA senza fattura -->
                <m:Button
                    text="OdA senza fattura"
                    icon="sap-icon://add-document"
                    press=".onOdaSenzaFattura"
                    type="Emphasized"
                />

                <!-- 3. Partitario Fornitore -->
                <m:Button
                    text="Partitario Fornitore"
                    icon="sap-icon://supplier"
                    press=".onPartitarioFornitore"
                    type="Emphasized"
                />

                <!-- 4. Fattura Logistica -->
                <m:Button
                    text="Fattura Logistica"
                    icon="sap-icon://shipping-status"
                    press=".onFatturaLogistica"
                    type="Emphasized"
                />

                <!-- 5. Fattura Contabile -->
                <m:Button
                    text="Fattura Contabile"
                    icon="sap-icon://expense-report"
                    press=".onFatturaContabile"
                    type="Emphasized"
                />

                <!-- 6. Lucchetto Blocco -->
                <m:Button
                    icon="sap-icon://locked"
                    tooltip="Blocca"
                    press=".onBlocca"
                    type="Transparent"
                />

                <!-- 7. Lucchetto Sblocco -->
                <m:Button
                    icon="sap-icon://unlocked"
                    tooltip="Sblocca"
                    press=".onSblocca"
                    type="Transparent"
                />

                <!-- 8. Archivia Fattura -->
                <m:Button
                    text="Archivia Fattura"
                    icon="sap-icon://save"
                    press=".onArchiviaFattura"
                    type="Emphasized"
                />

                <!-- 9. Storno Fattura -->
                <m:Button
                    text="Storno Fattura"
                    icon="sap-icon://reset"
                    press=".onStornoFattura"
                    type="Emphasized"
                />

                <!-- 10. Annulla Archiviazione -->
                <m:Button
                    text="Annulla Archiviazione"
                    icon="sap-icon://sys-cancel-2"
                    press=".onAnnullaArchiviazione"
                    type="Emphasized"
                />

                <!-- 11. Fattura logistica MIRO -->
                <m:Button
                    text="Fattura logistica MIRO"
                    icon="sap-icon://doc-attachment"
                    press=".onFatturaLogisticaMiro"
                    type="Emphasized"
                />
            </m:OverflowToolbar>
        </m:footer>
    </m:Page>
</mvc:View>
